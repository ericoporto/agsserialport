// room script file

SP_Port* _port;

function room_RepExec()
{
  if(_port == null) return;

  int byte_count = _port.WaitingBytesRead;
  if(byte_count > 0)
  {
    Display(_port.Read(byte_count)); 
  }
}

function room_AfterFadeIn()
{
  _port.Open(eAGSP_Mode_Read);
}

function room_Load()
{
  String portname;
  for(int i=0; i<AGSP.PortNamesCount; i++)
  {
    portname = AGSP.PortNames[i];
  }

  if(portname == null || portname.Length < 1)
  {
    return;
  }
    
  _port = SP_Port.Create(portname);  
}

function hGlowingOrb_AnyClick()
{
  if(_port == null) return;
  
  Display(String.Format("Serial Port Name: %s\nDescription: %s\n", _port.Name, _port.Description));
}
